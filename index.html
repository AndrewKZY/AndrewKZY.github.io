<!DOCTYPE html>
<html>
	<head>
		<meta name="apple-mobile-web-app-capable" content="yes">

		<script src="https://aframe.io/releases/0.7.0/aframe.min.js"></script>


		<!-- a-frame and community plugins--> 
        <script src="https://rawgit.com/rdub80/aframe-gui/master/dist/aframe-gui.min.js"></script>




		<!-- Use components defined in separate files. -->
		 	
		<script src="arrow-key-rotation.js"></script>
		<script src="handle-btn1.js"></script>
		<script src="handle-btn2.js"></script>
		<script src="hide-once-playing.js"></script>
		<script src="js/play-on-vrdisplayactivate-or-enter-vr.js"></script>
		<script src="js/scene1-onClick.js"></script>
		<script src="js/scene2-onClick.js"></script>
		
		<!-- Script needed to run video for now -->
		<script>
	      document.addEventListener("DOMContentLoaded", function(event) {
	        var scene = document.querySelector("a-scene");
	        var vid = document.getElementById("Level1Q1Vid");
	        var videosphere1 = document.getElementById("videosphere1");

	        if (scene.hasLoaded) {
	          run();
	        } else {
	          scene.addEventListener("loaded", run);
	        }
	        
	        function run () {
	          if(AFRAME.utils.device.isMobile()) {
	            //document.querySelector('#splash').style.display = 'flex';
	            document.querySelector('#splash').addEventListener('click', function () {
	              playVideo();
	              this.style.display = 'none';
	            })
	          } else {
	              playVideo();
	          }
	        }
	        
	        function playVideo () {
	          vid.play();
	          videosphere1.components.material.material.map.image.play();
	        }
	      })
    	</script>
		


	</head>

	<body>
		<a-scene>

			<!-- Asset management system. -->
			<a-assets>

				<video id="Level1Q1Vid"  src="video/scenes/scene_howFastAction.MP4"  preload="auto"  playsinline webkit-playsinline muted="muted"> </video>
				<video id="Level1Q2Vid"  src="video/scenes/scene_onePersonAction.MP4"  preload="auto" playsinline webkit-playsinline muted="muted"> </video>
			</a-assets>


			<!-- GUI items here..
			https://github.com/rdub80/aframe-gui/blob/master/README.md 
			Readme to understand futher -->
			<a-gui-flex-container 
			flex-direction="column" justify-content="center" align-items="normal" component-padding="0.1" opacity="0.7" width="3.5" height="4.5"
			position="2 2.5 -4" rotation="0 0 0"
			>
				
				<!-- Label text -->
				<a-gui-label 
				width="2.5" height="0.75"
				value="label text"
				font-family="Arial"
				margin="0 0 0.05 0"
				>
				</a-gui-label>

				<!-- Button that can click -->
				<a-gui-button 
				width="2.5" height="0.75"
				onclick="buttonActionFunction" key-code="32"
				value="test button"
				font-family="Arial"
				margin="0 0 0.05 0"
				>
				</a-gui-button>


			</a-gui-flex-container>

			
			<!-- scenes -->
			<a-entity id="scenes">
				<!-- scene 1 -->
				<a-videosphere id="videosphere1"
				rotation="0 180 0"
				visible="true"
				src="#Level1Q1Vid"
				show-btn-when-ended="target: #btn1"
				autoplay = "true"
				play-on-window-click>
				</a-videosphere>

				<!-- scene 2 -->
				<a-videosphere id="videosphere2"
				rotation="0 180 0"
				visible="false"
				src="#Level1Q2Vid"
				show-btn-when-ended="target: #btn2"> 
				</a-videosphere>
			</a-entity>

			<a-entity
				id="btn1"
				cursor-listener	geometry = "primative: plane"
				position = "-0.8 3 -12.3"
				rotation = "0 -1 -3"
				scale = "12.5 25 1"
				visible = "false"
				text = "align:center; width: 6; wrapCount:100; color:black;
						value: CLICK HERE"
				go-toScene-onCLick>
			</a-entity>


			<!-- Camera + cursor. -->
			<a-entity id="cameraRig" position="0 1.6 0">
				<a-camera look-controls wasd-controls position="0 0 0">
					<a-gui-cursor id="cursor"
					raycaster="objects: [gui-interactable]"
					fuse="true" fuse-timeout="2000"
					design="ring"
					>
				</a-gui-cursor> <!-- /cursor -->
			</a-camera> <!-- /camera -->
		</a-entity>



		</a-scene>

		<!-- 		show button when video 1 end  -->
		<script>
			document.getElementById("Level1Q1Vid").addEventListener("ended", showBtnFunction);

			function showBtnFunction() {
				var button = document.getElementById('btn1');
				button.setAttribute('visible', 'true');
			}
		</script>

<!-- 		<script>
			document.getElementById("btn1").addEventListener("click", goToSceneFunction);

			function goToSceneFunction() {
		  		var button = document.getElementById('btn1');
		     	button.setAttribute('visible', 'false');
			}
		</script>
 -->


	</body>
</html>

